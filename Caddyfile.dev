# Zeen Connect - Development Caddy Configuration
# Copy this file to /etc/caddy/Caddyfile and update with your domain
#
# Usage:
#   sudo cp Caddyfile.dev /etc/caddy/Caddyfile
#   sudo nano /etc/caddy/Caddyfile  # Update domain and email
#   sudo systemctl restart caddy

{
    # Your email for Let's Encrypt SSL certificates
    email joel.henry.023@gmail.com
}

# Main development domain
dev.zeenconnect.com, auth.dev.zeenconnect.com, console.dev.zeenconnect.com, *.dev.zeenconnect.com {

    # Proxy to Laravel app container
    reverse_proxy localhost:8080 {
        header_up X-Forwarded-Proto {scheme}
        header_up X-Forwarded-Host {host}
    }

    # Vite HMR WebSocket connections
    @vite_ws {
        path /@vite/*
        header Connection *Upgrade*
        header Upgrade websocket
    }
    handle @vite_ws {
        reverse_proxy localhost:5174
    }

    # Vite assets and HMR paths
    @vite_assets {
        path /@vite/*
        path /@id/*
        path /@fs/*
        path /node_modules/*
        path /resources/*
    }
    handle @vite_assets {
        reverse_proxy localhost:5174
    }
}

